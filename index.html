<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>图片自动列表</title>
<style>
    body {
        font-family: sans-serif;
        max-width: 1100px;
        margin: 40px auto;
        padding: 0 20px;
    }
    .img-grid {
        display: grid;
        grid-template-columns: repeat(5, 1fr); /* 一行固定5列 */
        gap: 16px;
    }
    .img-card {
        border: 1px solid #ddd;
        padding: 8px;
        border-radius: 6px;
        background: #fafafa;
        text-align: center;
        cursor: pointer; /* 点击手势 */
        user-select: none;
        transition: background 0.15s;
    }
    .img-card:hover {
        background: #f0f0f0;
    }
    .img-card img {
        width: 100%;
        max-height: 150px;
        object-fit: contain;
        border: 1px solid #ccc;
        background: white;
    }
    .img-name {
        font-size: 12px;
        margin-top: 6px;
        word-break: break-all;
        color: #444;
    }
    #msg {
        margin-top: 20px;
        font-size: 14px;
        color: #888;
    }
</style>
</head>
<body>

<h2>图片自动预览（点击即可复制地址）</h2>
<div id="img-list">加载中...</div>
<div id="msg"></div>

<script>
const owner = "Esic25";
const repo = "picx-images-hosting";
const directory = "data";

const apiURL = `https://api.github.com/repos/${owner}/${repo}/contents/${directory}`;

function showMsg(text) {
    const msg = document.getElementById("msg");
    msg.textContent = text;
    setTimeout(() => msg.textContent = "", 1500);
}

fetch(apiURL)
    .then(resp => resp.json())
    .then(files => {
        const container = document.getElementById("img-list");
        if (!Array.isArray(files)) {
            container.innerHTML = "无法获取文件列表";
            return;
        }

        container.innerHTML = '<div class="img-grid"></div>';
        const grid = container.querySelector(".img-grid");

        files
            .filter(f => f.type === "file")
            .filter(f => /\.(png|jpg|jpeg|gif|webp|svg)$/i.test(f.name))
            .forEach(f => {
                const rawURL = `https://${owner}.github.io/${repo}/${directory}/${f.name}`;

                const card = document.createElement("div");
                card.className = "img-card";

                card.innerHTML = `
                    <img src="${rawURL}">
                    <div class="img-name">${f.name}</div>
                `;

                // 点击图片卡片直接复制 URL
                card.addEventListener("click", () => {
                    navigator.clipboard.writeText(rawURL);
                    showMsg("已复制：" + f.name);
                });

                grid.appendChild(card);
            });
    })
    .catch(error => {
        document.getElementById("img-list").innerHTML = "加载失败：" + error;
    });
</script>

</body>
</html>
